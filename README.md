# PRS-Net
这是一个简单复现 PRS-Net: Planar Reﬂective Symmetry Detection Net for 3D Models 的工程。

* 因为本人笔记本的内存过小，训练时，网络后半部分同时使用三个旋转和三个对称支路会造成巨大的虚拟内存硬盘读写，甚至崩溃。因此在代码中暂且注释掉了旋转的支路。也可以注释掉对称支路，保留旋转支路。实际上只需要切换loss即可。

* 基于 windows10
* 基于 tensorflow 2.2.0
* 训练十分费时，但运行速度非常快，经过排查绝大部分时间花在了对称Loss的梯度求解上。
* 简单使用146个样本进行了5个epoch的训练，loss大概降低到2300左右，简单验证了实现的正确性。
* 体素化使用了[binvox](https://www.patrickmin.com/binvox/)

## 使用说明
* 训练使用的146个原始数据达300MB，因此没有上传。
* 需要提前对模型文件进行随机旋转。
* 因实验数据量较小，本处直接使用.npy存储输入数据，大规模训练推荐使用.tfrecord文件。
* 提供了采样点与对称平面的可视化函数，result文件夹内有其效果。但是效果一般，考虑在obj上进行可视化。
* 论文中对称公式以及正则损失的公式似乎存在笔误，实现中进行了纠正。
